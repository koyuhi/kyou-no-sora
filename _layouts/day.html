<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ page.title }} - {{ site.title }}</title>
    <link rel="stylesheet" href="/assets/css/reset.css" />
    <link rel="stylesheet" href="/assets/css/style.css" />
    <!-- å¿…è¦ãªã‚‰ Vue ã® CDN ã‚‚ã“ã“ã§èª­ã¿è¾¼ã‚€ -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v6.7.2/css/all.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=M+PLUS+1p&family=Noto+Sans+JP:wght@100..900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="days">
    <header>
      <div class="wrapper">
        <div class="header-title">
          <a href="/">{{ site.title }}</a>
        </div>
      </div>
    </header>
    <main>
      <div class="wrapper">
        <div id="app">
          <h1><span v-text="formattedDate"></span>ã®ç©ºã‚‚ã‚ˆã†</h1>

          <!-- åŒ—ãƒ»æ±ãƒ»å—ãƒ»è¥¿ ãƒœã‚¿ãƒ³ -->
          <nav class="direction-nav">
            <a
              v-for="d in directions"
              @click="currentDir = d"
              v-text="d"
              :class="{ active: currentDir === d }"
              ><span>{{ d }}</span></a
            >
          </nav>

          <!-- ç”»åƒè¡¨ç¤º -->
          <div v-if="currentDir && date">
            <h2>{{ currentDir }}</h2>
            <img :src="getPhotoUrl(currentDir)" :alt="currentDir" />
          </div>
          <p class="right" v-text="currentDir + 'ã®ãã‚‰'"></p>
          <!-- ã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤º -->
          <div v-if="comment">
            <h3>ä»Šæ—¥ã®ã‚³ãƒ¡ãƒ³ãƒˆ</h3>
            <p v-text="comment"></p>
          </div>

          <!-- æ°—åœ§é…ç½®å›³è¡¨ç¤º -->
          <div v-if="date" class="pressure-chart">
            <h2>ğŸ”¹æ°—åœ§é…ç½®å›³ğŸ”¹</h2>
            <p class="font90">â€»å†™çœŸæ’®å½±æ™‚é–“ã«è¿‘ã„ã‚‚ã®ã‚’è¡¨ç¤º</p>
            <img
              :src="getPressureUrl()"
              alt="æ°—åœ§é…ç½®å›³"
              class="pressure-img"
            />
            <p class="right">(æ°—è±¡åºHPã‚ˆã‚Š)</p>
          </div>
        </div>
      </div>
    </main>
    <footer>
      <div class="wrapper">
        <p>&copy; {{ site.time | date: "%Y" }} {{ site.title }}</p>
      </div>
    </footer>

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <script>
        const { createApp } = Vue;

        createApp(
          {
            data() {
                return {
                    date: new URLSearchParams(window.location.search).get("date") || "20251114",
                    directions: ["åŒ—", "æ±", "å—", "è¥¿"],
                    currentDir: "åŒ—",
                    comments: {{ site.data.days | jsonify }}  // ã“ã‚Œã‚’å¿…ãšå…¥ã‚Œã‚‹
                };
            },
            computed: {
                comment() {
                    return this.comments[this.date]?.comment || "";
                },
                formattedDate() {
                    const y = this.date.slice(0, 4);
                    const m = this.date.slice(4, 6);
                    const d = this.date.slice(6, 8);
                    const dt = new Date(`${y}-${m}-${d}`);

                    return new Intl.DateTimeFormat("ja-JP", {
                    weekday: "short",
                    year: "numeric",
                    month: "long",
                    day: "numeric",
                    }).format(dt);
                }
            },
            methods: {
                getPhotoUrl(dir) {
                    const map = { åŒ—: "north", æ±: "east", å—: "south", è¥¿: "west" };
                    return `/photos/${this.date}/${map[dir]}.jpg`;
                },
                getPressureUrl() {
                    return `/photos/${this.date}/pressure.png`;
                }
            },
            mounted() {
                document.title = `${this.$options.title || 'ã“ã®æ—¥ã®å†™çœŸ'}ï¼š${this.formattedDate} - ä»Šæ—¥ã®ç©ºã‚‚ã‚ˆã†`;
            }
        }
      ).mount("#app");
    </script>
  </body>
</html>
